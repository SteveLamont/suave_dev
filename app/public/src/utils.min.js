function bucketByName(e,t){for(var i=0;i<e.length;i++)if(e[i].hasValue(t))return e[i];return null}function poz(e){var t,i,r;return 0==e?i=0:(t=.5*Math.abs(e),t>=3?i=1:t<1?(r=t*t,i=((((((((.000124818987*r-.001075204047)*r+.005198775019)*r-.019198292004)*r+.059054035642)*r-.151968751364)*r+.319152932694)*r-.5319230073)*r+.797884560593)*t*2):(t-=2,i=(((((((((((((-45255659e-12*t+.00015252929)*t-19538132e-12)*t-.000676904986)*t+.001390604284)*t-.00079462082)*t-.002034254874)*t+.006549791214)*t-.010557625006)*t+.011630447319)*t-.009279453341)*t+.005353579108)*t-.002141268741)*t+.000535310849)*t+.999936657524)),e>0?.5*(i+1):.5*(1-i)}function ex(e){return e<-BIGX?0:Math.exp(e)}function pochisq(e,t,i){var r,n,a,o,s,l,u,v=(t-1)*(i-1);if(e<=0||v<1)return 1;if(r=.5*e,u=!(1&v),v>1&&(n=ex(-r)),a=u?n:2*poz(-Math.sqrt(e)),v>2){if(e=.5*(v-1),l=u?1:.5,r>BIGX){for(o=u?0:.5723649429247001,s=Math.log(r);l<=e;)o=Math.log(l)+o,a+=ex(s*l-r-o),l+=1;return a}for(o=u?1:.5641895835477563/Math.sqrt(r),s=0;l<=e;)o*=r/l,s+=o,l+=1;return s*n+a}return a}Debug.log=function(e){window.console&&window.console.log&&"undefined"!=typeof debug&&1==debug&&window.console.log(e)},window.requestAnimFrame=function(e){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),PivotViewer.Utils.escapeMetaChars=function(e){return e.replace(/\|/gi,"\\|").replace(/\//gi,"\\/").replace(/'/gi,"\\'").replace(/,/gi,"\\,").replace(/:/gi,"\\:").replace(/\(/gi,"\\(").replace(/\)/gi,"\\)").replace(/\+/gi,"\\+").replace(/\+/gi,"\\-").replace(/\+/gi,"\\_").replace(/\+/gi,"\\%").replace(/\./gi,"\\_")},PivotViewer.Utils.htmlSpecialChars=function(e){return jQuery("<div />").text(e).html()},PivotViewer.Utils.now=function(){return Date.now?Date.now():(new Date).getTime()},PivotViewer.Utils.getOrdinalHistogram=function(e){if(!e instanceof Array)return null;for(var t=Math.min.apply(null,e),i=Math.max.apply(null,e),r=i-t+1,n=[],a=0;a<r;a++)n[a]=0;for(var a=0;a<e.length;a++)n[e[a]-t]++;return{histogram:n,min:t,max:i}},PivotViewer.Utils.getHistogram=function(e){if(!e instanceof Array)return null;var t=Math.min.apply(null,e),i=Math.max.apply(null,e),r=2*(Math.floor(Math.pow(2*e.length,1/3))+1);r>e.length?r=e.length:r>10&&(r=10);for(var n=1==r?i-t+1:(i-t)/(r-1),a=[],o=0;o<r;o++)a[o]=0;for(var o=0;o<e.length;o++)a[Math.floor((e[o]-t)/n)]++;return{histogram:a,min:t,max:i}},function(e){e.widget("suave.modSlider",e.ui.slider,{getValues:function(){return this.options.values},getOptions:function(){return{min:this.options.min,max:this.options.max}},clearValues:function(){this.options.values=[this.options.min,this.options.max],this._refresh()},updateValues:function(e){this.options.values=e,this._refresh()},changeValues:function(e){for(var t=0;t<e.length;t++)e[t]=Math.floor(e[t]/this.options.step)*this.options.step;this.options.values=e,this._refresh()},addValue:function(e){e=Math.floor(e/this.options.step)*this.options.step,this.options.values.push(e),this.options.values.sort(),this._refresh()},removeValue:function(e){this.options.values.splice(e,1),this._refresh()}})}(jQuery),$.fn.bindFirst=function(e){this.on.apply(this,arguments),this.each(function(){var t=$._data(this,"events")[e.split(".")[0]],i=t.pop();t.splice(0,0,i)})},function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;Object.subClass=function(i){function r(){!e&&this.init&&this.init.apply(this,arguments)}var n=this.prototype;e=!0;var a=new this;e=!1;for(var o in i)a[o]="function"==typeof i[o]&&"function"==typeof n[o]&&t.test(i[o])?function(e,t){return function(){var i=this._super;this._super=n[e];var r=t.apply(this,arguments);return this._super=i,r}}(o,i[o]):i[o];return r.prototype=a,r.constructor=r,r.subClass=arguments.callee,r}}(),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return 0===this.lastIndexOf(e,0)}),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&e>-9007199254740992&&e<9007199254740992&&Math.floor(e)===e});var tileSortBy=function(e,t,i){var r,n=PivotCollection.getCategoryByName(e),a=[];if(void 0!=i)for(var o=0;o<i.length;o++)a[i[o]]=!0;return r=n.isNumber()||n.isOrdinal()?function(t){var i=t.item.getFacetByName(e);return void 0==i?1/0:i.values[0].value}:n.isDateTime()?function(t){var i=t.item.getFacetByName(e);return void 0==i?new Date(864e13):new Date(i.values[0].value)}:function(t){var i=t.item.getFacetByName(e);if(void 0==i)return"ZZZZZZZ";for(var r=i.values,n=0;n<r.Length;n++)if(a[r[n]])return r[n].value.toUpperCase();return r[0].value.toUpperCase()},t=void 0==t?-1:[-1,1][+!!t],function(e,i){return e=r(e),i=r(i),t*((i>e)-(e>i))}};PivotViewer.Utils.getMonthName=function(e){return["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]},PivotViewer.Utils.getHour=function(e){var t=e.getHours();return 0==t?12:t>12?t-12:t},PivotViewer.Utils.getSeconds=function(e){var t=e.getSeconds();return t<10?"0"+t:t},PivotViewer.Utils.getMinutes=function(e){var t=e.getMinutes();return t<10?"0"+t:t},PivotViewer.Utils.getMeridian=function(e){return e.getHours()>11?"PM":"AM"},PivotViewer.Utils.getTimeValueFn=function(e,t){return t.getFullYear()-e.getFullYear()+e.getFullYear()%10>9?function(e){var t=new Date(e.value).getFullYear();return t-t%10}:t.getFullYear()>e.getFullYear()?function(e){return new Date(e.value).getFullYear()}:t.getMonth()>e.getMonth()?function(e){return new Date(e.value).getMonth()}:t.getDate()>e.getDate()?function(e){return new Date(e.value).getDate()}:t.getHours()>e.getHours()?function(e){return new Date(e.value).getHours()}:t.getMinutes()>e.getMinutes()?function(e){return new Date(e.value).getMinutes()}:function(e){return new Date(e.value).getSeconds()}},PivotViewer.Utils.getTimeLabelFn=function(e,t){return t.getFullYear()-e.getFullYear()+e.getFullYear()%10>9?function(e){var t=new Date(e.value).getFullYear();return t-t%10+"s"}:t.getFullYear()>e.getFullYear()?function(e){return new Date(e.value).getFullYear().toString()}:t.getMonth()>e.getMonth()?function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getFullYear()}:t.getDate()>e.getDate()?function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()}:t.getHours()>e.getHours()?function(e){var t=new Date(e).value;return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+" "+PivotViewer.Utils.getMeridian(t)}:t.getMinutes()>e.getMinutes()?function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+":"+PivotViewer.Utils.getMinutes(t)+" "+PivotViewer.Utils.getMeridian(t)}:function(e){var t=new Date(e.value);return PivotViewer.Utils.getMonthName(t)+" "+t.getDate()+", "+t.getFullYear()+" "+PivotViewer.Utils.getHour(t)+":"+PivotViewer.Utils.getMinutes(t)+"::"+PivotViewer.Utils.getSeconds(t)+" "+PivotViewer.Utils.getMeridian(t)}},PivotViewer.Utils.fillBuckets=function(e,t,i,r){void 0==r&&(r=function(e){return e.value}),e.ids=[];var i=PivotCollection.getCategoryByName(i);if(i.isNumber()||i.isOrdinal())for(var n=0,a=0;n<t.length;n++){var o=t[n],s=o.item.getFacetByName(i.name);if(void 0==s)break;if(!o.missing){var l=s.values[0];r(l)>=e[a].endRange&&a<e.length-1&&a++,e[a].addTile(o),e.ids[o.item.id]=a}}else for(var n=0;n<t.length;n++){var o=t[n],s=o.item.getFacetByName(i.name);if(void 0==s)break;if(!o.missing){var a=e.values[r(s.values[0])];e[a].addTile(o),void 0==e.ids[o.item.id]?e.ids[o.item.id]=[a]:e.ids[o.item.id].push(a)}}},PivotViewer.Utils.getBuckets=function(e,t,i,r){void 0==i&&(i=function(e){return e.value}),void 0==r&&(r=function(e){return e.toString()});for(var n=0;n<PivotViewer.Models.string_filters.length;n++)if(PivotViewer.Models.string_filters[n].facet==t)var a=PivotViewer.Models.string_filters[n].value;for(var o=PivotCollection.getCategoryByName(t),s=o.isMultipleItems,l=new Set(a),u=[],v=e[0].item.getFacetByName(t).values[0],g=i(v),f=e[0],c=f.item.getFacetByName(t),h=_.flatten(_.pluck(c.values,"value")),d=0;d<h.length;d++){var p=h[d];g=p;var m=g;if(!s||0==l.size||l.has(g)){for(va in c.values){var w=c.values[va].label;if(o.isNumber()||o.isOrdinal()?(w=parseFloat(w.replace(/,/g,"").match(/(?:-?\d+\.?\d*)|(?:-?\d*\.?\d+)/)[0]),$.isNumeric(w)&&(w=r(w))):o.isDateTime()&&(w=moment(w,moment.parseFormat(w))._d.toString()),-1!=w.indexOf(g)){if(o.isDateTime()){var M=new Date(w);m=M.toLocaleDateString()}else m=c.values[va].label;break}}var y;y=new PivotViewer.Models.Bucket(g,m),y.addTile(f),y.addValue(g),u.push(y)}}for(var n=1,V=0;n<e.length;n++){var f=e[n],c=f.item.getFacetByName(t);if(void 0==c)break;if(!f.missing)for(var h=_.flatten(_.pluck(c.values,"value")),d=0;d<h.length;d++){var p=h[d];if(g=p,!s||0==l.size||l.has(g)){for(var y=null,V=0;V<u.length;V++)if(u[V].hasValue(g)){y=u[V];break}if(!y){for(va in c.values){var w=c.values[va].label;if(o.isNumber()||o.isOrdinal()?(w=parseFloat(c.values[va].label.replace(/,/g,"").match(/(?:-?\d+\.?\d*)|(?:-?\d*\.?\d+)/)[0]),$.isNumeric(w)&&(w=r(w))):o.isDateTime()&&(w=moment(w,moment.parseFormat(w))._d.toString()),-1!=w.indexOf(g)){if(o.isDateTime()){var M=new Date(w);m=M.toLocaleDateString()}else m=c.values[va].label;break}}y=new PivotViewer.Models.Bucket(g,m),u.push(y)}f.index=n,y.addTile(f),y.addValue(g)}}}if(s)for(var n=0;n<u.length-1;n++)for(var V=n+1;V<u.length;V++)if(u[n].startLabel.localeCompare(u[V].endLabel)>0){var w=u[n];u[n]=u[V],u[V]=w}if(u.length>10){var F=Math.ceil(u.length/10),b=[];b.ids=[];for(var P=0,D=0;P<u.length;P++){var U,N=P%F,y=u[P];0==N?(b[D]=y,U=b[D]):(U=b[D],U.endRange=y.endRange,U.endLabel=y.endLabel,Array.prototype.push.apply(U.tiles,y.tiles),Array.prototype.push.apply(U.values,y.values));for(var S in y.ids)U.ids[S]=!0,void 0==b.ids[S]?b.ids[S]=[D]:b.ids[S].push(D);N+1==F&&D++}u=b}else{u.ids=[];for(var V=0;V<u.length;V++)for(var S in u[V].ids)void 0==u.ids[S]?u.ids[S]=[V]:u.ids[S].push(V)}if(n!=e.length&&Settings.showMissing){var x=new PivotViewer.Models.Bucket("(no info)","(no info");u.push(x);for(var D=u.length-1;n<e.length;n++)x.addTile(e[n]),x.ids[e[n].item.id]=!0,u.ids[e[n].item.id]=D}return u},PivotViewer.Utils.loadScript=function(e){if(0==$("script[src*='"+e+"']").length){var t=document.createElement("script");t.type="text/javascript",t.src=e,$("head").append(t)}},PivotViewer.Utils.loadCSS=function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e};var BIGX=20;